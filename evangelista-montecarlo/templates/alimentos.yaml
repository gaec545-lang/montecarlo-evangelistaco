# TEMPLATE UNIVERSAL PARA INDUSTRIA ALIMENTOS
# Versión: 1.0

industry:
  name: "alimentos"
  description: "Negocios de transformación y venta de alimentos"

common_variables:
  - name: "precio_harina"
    description: "Costo por kilogramo de harina"
    unit: "MXN/kg"
    typical_range: [15, 30]
    
  - name: "precio_azucar"
    description: "Costo por kilogramo de azúcar"
    unit: "MXN/kg"
    typical_range: [18, 35]
    
  - name: "demanda_unidades"
    description: "Unidades vendidas por mes"
    unit: "unidades/mes"
    typical_range: [500, 5000]

# Configuración para conexión directa a Data Mesh del cliente (Production)
# Ecosistema: Microsoft Azure / SQL Server
data_sources:
  - type: "database"
    engine: "mssql"  # Dialecto para Microsoft SQL Server
    host: "servidor-cliente.database.windows.net"
    port: 1433       # Puerto estándar de SQL Server
    database: "bodega_datos_cliente"
    username: "evangelista_sentinel"
    password: "${DB_PASSWORD}"  # Inyectado por el entorno de ejecución
    tables:
      - table: "fact_costos_insumos"
        date_column: "fecha_registro"
        value_column: "costo_unitario"
        maps_to_variable: "precio_harina"
        filters:
          insumo_id: "HARINA_001"
          cliente_id: "${CLIENT_ID}"
        start_date: "2024-01-01"
      
      - table: "fact_costos_insumos"
        date_column: "fecha_registro"
        value_column: "costo_unitario"
        maps_to_variable: "precio_azucar"
        filters:
          insumo_id: "AZUCAR_001"
          cliente_id: "${CLIENT_ID}"
        start_date: "2024-01-01"    

business_model:
  template: |
    def modelo_alimentos(variables, config):
        ingresos = variables['demanda_unidades'] * config['precio_venta_unitario']
        costo_materias_primas = 0
        for insumo, cantidad_por_unidad in config['receta'].items():
            precio_insumo = variables.get(f'precio_{insumo}', 0)
            costo_materias_primas += precio_insumo * cantidad_por_unidad * variables['demanda_unidades']
        costos_fijos = config['costo_fijo_mensual']
        return ingresos - costo_materias_primas - costos_fijos
  
  parameters_required:
    - precio_venta_unitario
    - receta
    - costo_fijo_mensual

default_distributions:
  precio_harina:
    type: "triangular"
    fallback:
      min_pct: -0.10
      mode_pct: 0.00
      max_pct: 0.15
  
  precio_azucar:
    type: "triangular"
    fallback:
      min_pct: -0.10
      mode_pct: 0.00
      max_pct: 0.15
  
  demanda_unidades:
    type: "normal"
    fallback:
      mean: 2400
      std: 300

thresholds:
  high_volatility: 0.35
  critical_loss_prob: 0.25
  margin_protection: 0.30
